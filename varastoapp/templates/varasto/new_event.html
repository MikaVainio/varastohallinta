{% extends "varasto/base_main.html" %}

{% load static %}

{% block stylesheet %}
<link rel="stylesheet" type="text/css" href="{% static 'varasto/new_event.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'varasto/base_main.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
{% endblock %}

{% block title %}Uusi tapahtuma{% endblock %}
{% block path %}Uusi tapahtuma{% endblock %}
{% block page %}Uusi tapahtuma{% endblock %}

{% block main_content %}

<div class="new_event_warp">
    <form method="get" action="">
        <div class="d-flex justify-content-center pt-5" style="">
            <div class="d-flex flex-column align-items-end w-50">
                <div class="row g-3 w-100">
                    <div class="col-auto w-100">
                        {% comment %} {% csrf_token %} {% endcomment %}
                        
                        <div class="d-flex align-items-end">
                            <div class="mb-3 me-3 w-100">
                                <label for="exampleFormControlInput1" class="form-label">Skannaa opiskelijakortti tai kirjoittaa opiskelijanumero.</label>
                                {% if not changed_user %}
                                <input name="add_user" type="text" class="form-control" id="exampleFormControlInput1" placeholder="kirjoittaa opiskelijanumero tai hänen nimi">
                                {% else %}
                                <input name="add_user" value="{{changed_user.code}}" type="text" class="form-control" id="exampleFormControlInput1" >
                                {% endif %}
                            </div>
                            <div class="mb-3">
                                <button name="_add_user" type="submit" class="list__button list__button_bg_green btn_strech">
                                    <span class="bi bi-plus font-size"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-auto w-100" style="{% if changed_user %}display: block{%else%}display: none{%endif%};">
                        <div class="d-flex flex-row justify-content-between">
                            <div class="mb-3 me-3">
                                <h4>{{changed_user.first_name}} {{changed_user.last_name}}</h4>
                                <p>{{changed_user.email}}</p>
                            </div>
                            <div class="mb-3 d-flex">
                                <button name="_remove_user" type="submit" class="list__button list__button_bg_red btn_strech">
                                    <span class="bi bi-dash font-size"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-3 mt-3 w-100 mb-4">
                    <div class="col-auto w-100">
                        <div class="d-flex align-items-end">
                            
                            <div class="mb-3 me-3 w-100">
                                <label for="exampleFormControlInput1" class="form-label">Skannaa tuote, kirjoittaa käsin tuotenumero tai lisää napilla.</label>
                                <input name="add_item{{changed_items|length}}" type="text" class="form-control" id="exampleFormControlInput1" placeholder="kirjoittaa tuotenumero">
                            </div>
                            <div class="mb-3 me-3">
                                <button type="button" class="list__button list__button_bg_green btn_strech btn-small">
                                    <span class="list__button__text">Lisää tuote</span>
                                </button>
                            </div>
                            <div class="mb-3">
                                <button type="submit" class="list__button list__button_bg_green btn_strech">
                                    <span class="bi bi-plus font-size"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                {{changed_items|length}}
                {% for changed_item in changed_items %}
                <div class="col-auto w-100" style="{% if changed_items %}display: block{%else%}display: none{%endif%};">
                    <div class="d-flex flex-row justify-content-between px-2" >
                        <div class="mb-3 me-3">
                            <input name="add_item{{forloop.counter0}}" value="{{changed_item.id}}" type="hidden" class="form-control" id="exampleFormControlInput1" placeholder="kirjoittaa tuotenumero">
                            <h4>{{changed_item.item_name}} {{changed_item.brand}} {{changed_item.model}}</h4>
                            <p>{{changed_item.item_type}} {{changed_item.parameters}} {{changed_item.size}}</p>
                        </div>
                        <div class="mb-3 d-flex">
                            <button type="submit" name="_remove_item" value="{{forloop.counter0}}" class="list__button list__button_bg_red btn_strech">
                                <span class="bi bi-dash font-size"></span>
                            </button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </form>
    
    <div class="main_buttons right pb-2 pe-2">
        <div>
            <form action="" method="post">
                {% csrf_token %}
                <input name="add_user" value="{{changed_user}}" type="hidden" class="form-control" id="exampleFormControlInput1" >
                {% for changed_item in changed_items %}
                <input name="add_item{{forloop.counter0}}" value="{{changed_item.id}}" type="hidden" class="form-control" id="exampleFormControlInput1" placeholder="kirjoittaa tuotenumero">
                {% endfor %}
                <button type="button" class="button_s me-5">
                    <span class="button_s__text">PERUUTA</span>
                </button> 
                <button type="submit" class="button_s">
                    <span class="button_s__text">TALLENNA</span>  
                </button>
            </form>
        </div>
    </div>
</div>

{% endblock %}
