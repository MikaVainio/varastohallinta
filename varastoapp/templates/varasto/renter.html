{% extends "varasto/base_main.html" %}

{% load static %}

{% block stylesheet %}
<link rel="stylesheet" type="text/css" href="{% static 'varasto/renter.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'varasto/base_main.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
{% endblock %}

{% block title %}Vuokraaja {{ selected_user.first_name }} {{ selected_user.last_name }}{% endblock %}
{% block path %}Vuokraaja {{ selected_user.first_name }} {{ selected_user.last_name }}{% endblock %}
{% block page %}Vuokraaja {{ selected_user.first_name }} {{ selected_user.last_name }}{% endblock %}

{% block main_content %}
    <div class="main_warp">
        <div class="person_info">
            <div class="photo">
                <!-- <div><img src="{% static 'varasto/pics/people/portrait-800.jpg' %}" alt="portrait.jpg"></div> -->
                <div><img src="{% static selected_user.photo %}" alt="{{selected_user.photo}}"></div>
            </div>
            <div class="information ps-3">
                <span class="student_name">{{ selected_user.first_name }} {{ selected_user.last_name }}</span>
                <span class="student_group">{{ selected_user.group|default:"-" }}</span>
                <span class="personal_field_name">Puhelin</span>
                <span class="personal_field_data">{{ selected_user.phone|default:"-" }}</span>
                <span class="personal_field_name">Sähköposti</span>
                <span class="personal_field_data">{{ selected_user.email|default:"-" }}</span>
                <span class="personal_field_name">Vastuopettaja</span>
                <span class="personal_field_data">{{ selected_user.responsible_teacher.first_name|default:"-" }} {{ selected_user.responsible_teacher.last_name|default_if_none:"" }}</span>
            </div>
            <div class="new_rental">
                <a class="nodecor" href="#">
                    <button type="button" class="button button_bg_green resize">
                        <span class="button__text resize">Uusi tapahtuma</span>
                        <span class="button__icon">+</span>
                    </button>
                </a>
            </div>

        </div>

        
        <div class="history">
            {% for rental_event in rental_events %}
            <div class="history_list">
                <div class="history_photo">
                    <div><img src="{% static rental_event.item.picture %}" alt="{{rental_event.item.picture}}"></div>
                </div>

                <div class="item_info">
                    <div>
                        <span class="item_name">{{rental_event.item.item_name}} {{rental_event.item.brand}}</span>
                        <span class="item_props">{{rental_event.item.model|default_if_none:""}} {{rental_event.item.item_type|default_if_none:""}} {{rental_event.item.parameters|default_if_none:""}} {{rental_event.item.size|default_if_none:""}}</span>
                    </div>
                    <div class="item_info_place">
                        <span class="item_num">{{rental_event.storage.rack}} - {{rental_event.storage.shelf}} - {{rental_event.storage.place}}</span>
                    </div>
                    <span class="item_num_name">Tuotekoodi</span>
                    <span class="item_num">{{rental_event.id_start_null}}</span>
                    <!-- <span class="item_num">{{rental_event.item.id}}</span> -->
                </div>

                <div class="rental_period">
                    <span class="rental_period_date">{{rental_event.start_date|date:'d.m.Y'}} - {{rental_event.estimated_date|date:'d.m.Y'}}</span>
                    {% if not rental_event.returned_date and rental_event.is_past_due %}
                        <div class="list__rented_item_status">
                            <div class="status_green"><span>Lainalla</span></div>
                        </div>
                        {% else %}{% if not rental_event.returned_date and not rental_event.is_past_due %}
                        <div class="list__rented_item_status">
                            <div class="status_red"><span>Erääntynyt</span></div>
                        </div>
                        {% else %}{% if rental_event.returned_date %}
                        <div class="list__rented_item_status">
                            <div class="status_gray"><span>Päättänyt</span></div>
                        </div>
                        {% endif %}
                        {% endif %}
                    {% endif %}
                </div>
                
                <div class="update_event">
                    <div class="buttons">
                        <button type="button" class="list__button list__button_bg_blue btn_strech" data-bs-toggle="modal" data-bs-target="#UpdateWindow">
                            <span class="list__button__text ">Päivittää</span>
                        </button>
                    </div>
                    <div class="buttons">
                        <button type="button" class="list__button list__button_bg_blue btn_strech" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#qqq" data-bs-whatever="@mdo">
                            <span class="list__button__text ">Lopettaa</span>
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}

            
        </div>
        

    </div>

    <!-- Modal 1 -->
    <div class="modal fade" id="UpdateWindow" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {% include "varasto/vuokraus_tilanne1.html" %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal 2 -->
    <div class="modal fade" id="qqq" tabindex="-1" aria-labelledby="exampleModalLabel2" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel2">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {% include "varasto/vuokraus_tilanne1.html" %}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
